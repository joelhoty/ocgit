<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>opencv_imageclassfy_task4_b02</title>
    
    <!-- CSS æ¡†æ¶ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.min.css">
    
    <!-- ä»£ç¢¼é«˜äº® -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/base16/darcula.min.css">
    
    <!-- è‡ªå®šç¾©æ¨£å¼ -->
    <style>
        
                body {
                    max-width: 900px;
                    margin: 0 auto;
                    padding: 20px;
                }
                /* æå‡ä»£ç å—å¯¹æ¯”åº¦ */
                pre {
                    background: #1e1e1e !important;
                    border: 1px solid #3e3e3e;
                }
                pre code {
                    background: #1e1e1e !important;
                }
                code {
                    background: #2d2d2d !important;
                }
                /* å¼•ç”¨å—å¯¹æ¯”åº¦ */
                blockquote {
                    background: #2d2d2d;
                    border-left: 4px solid #4a9eff;
                }
            
        
        /* é€šç”¨ä»£ç¢¼å¡Šæ¨£å¼ */
        pre code {
            display: block;
            padding: 1.5em;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.6;
        }

        /* Mermaid åœ–è¡¨æ¨£å¼ */
        
        .mermaid {
            margin: 2em 0;
            padding: 1.5em;
            text-align: center;
            border-radius: 8px;
        }
        
        .mermaid {
            background: #2c3034;
            border: 1px solid #444;
        }
            
        
        /* éŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container, .markdown-body, .latex-body, .window-body, .nes-container {
                padding: 15px;
            }
            pre code {
                padding: 1em;
            }
        }
        
        
    </style>
</head>
<body>
    <div class="container"><!-- Path: General_python/openCV/å½±åƒè¾¨è­˜-å‚³çµ±æ–¹æ³• | Timestamp: 2025-10-07 10:00:00 | Version: b02 -->
<h1>é¡Œç›®å››ï¼šéŠæˆ²ç•«é¢é“å…·å®šä½ç³»çµ±</h1>
<h2>ğŸ“‹ ä»»å‹™èªªæ˜</h2>
<p>è«‹æ’°å¯«ä¸€å€‹ Python ç¨‹å¼ï¼Œèƒ½å¤ åœ¨ä¸€å¼µè¤‡é›œçš„éŠæˆ²ç•«é¢æˆªåœ–ä¸­ï¼Œç²¾æº–åœ°æ‰¾åˆ°æ‰€æœ‰æŒ‡å®šçš„é“å…·åœ–ç¤ºï¼ˆä¾‹å¦‚ï¼šè—¥æ°´ã€é‡‘å¹£ï¼‰çš„ä½ç½®ã€‚æœ¬ä»»å‹™çš„æ ¸å¿ƒæ˜¯å­¸ç¿’ <strong>æ¨¡æ¿åŒ¹é… (Template Matching)</strong> æŠ€è¡“ï¼Œå®ƒé©ç”¨æ–¼å°‹æ‰¾å¤–è§€ã€å°ºå¯¸èˆ‡æ—‹è½‰è§’åº¦å›ºå®šçš„ç‰©é«”ã€‚</p>
<hr />
<h2>ğŸ–¼ï¸ å½±åƒé¸æ“‡æŒ‡å¼•</h2>
<h3>é©åˆçš„å½±åƒé¡å‹</h3>
<h4>âœ… æ¨è–¦ä½¿ç”¨çš„å½±åƒ</h4>
<ol>
<li>
<p><strong>åƒç´ ç´šä¸€è‡´çš„ç›®æ¨™</strong></p>
<ul>
<li><strong>ç‰¹å¾µ</strong>ï¼šéŠæˆ² UI æˆ–é“å…·åœ–ç¤ºèˆ‡ä½ è¦å°‹æ‰¾çš„ã€Œæ¨¡æ¿åœ–ç‰‡ã€åœ¨å°ºå¯¸ã€è§’åº¦å’Œå¤–è§€ä¸Šå®Œå…¨ä¸€è‡´ã€‚</li>
<li><strong>åµæ¸¬æˆåŠŸç‡</strong>ï¼šâ˜…â˜…â˜…â˜…â˜…ï¼ˆ95%+ï¼‰</li>
<li><strong>æœ€ä½³ç¯„ä¾‹</strong>ï¼šå¾åŸå§‹éŠæˆ²æˆªåœ–ä¸­ç›´æ¥ã€ç²¾ç¢ºåœ°è£å‰ªä¸‹ä¾†çš„åœ–ç¤ºä½œç‚ºæ¨¡æ¿ã€‚</li>
</ul>
</li>
<li>
<p><strong>é«˜å°æ¯”åº¦ã€ç„¡é®æ“‹çš„åœ–ç¤º</strong></p>
<ul>
<li><strong>ç‰¹å¾µ</strong>ï¼šç›®æ¨™åœ–ç¤ºå®Œæ•´é¡¯ç¤ºï¼Œä¸”èˆ‡èƒŒæ™¯æœ‰æ˜é¡¯å€åˆ¥ã€‚</li>
<li><strong>åµæ¸¬æˆåŠŸç‡</strong>ï¼šâ˜…â˜…â˜…â˜…â˜†ï¼ˆ90%+ï¼‰</li>
</ul>
</li>
</ol>
<h4>âš ï¸ æ•ˆæœè¼ƒå·®çš„å½±åƒ</h4>
<ol>
<li><strong>ç¶“éç¸®æ”¾æˆ–æ—‹è½‰</strong>ï¼šæ¨¡æ¿åŒ¹é…å°å°ºå¯¸å’Œè§’åº¦è®ŠåŒ–<strong>æ¥µåº¦æ•æ„Ÿ</strong>ï¼Œä»»ä½•è®Šå½¢éƒ½æœƒå°è‡´åŒ¹é…å¤±æ•—ã€‚</li>
<li><strong>æœ‰é€æ˜åº¦æˆ–ç‰¹æ•ˆ</strong>ï¼šåŠé€æ˜ã€ç™¼å…‰ç­‰ç‰¹æ•ˆæœƒæ”¹è®Šåƒç´ å€¼ï¼Œå¹²æ“¾åŒ¹é…ã€‚</li>
<li><strong>åœ–ç‰‡å£“ç¸®å¤±çœŸ</strong>ï¼šJPG ç­‰æœ‰æå£“ç¸®æœƒç”¢ç”Ÿå™ªé»ï¼Œå»ºè­°æ¨¡æ¿å’Œä¸»åœ–éƒ½ä½¿ç”¨ PNG æ ¼å¼ã€‚</li>
</ol>
<h4>âŒ å®Œå…¨ä¸é©åˆçš„å½±åƒ</h4>
<ul>
<li>ç›®æ¨™ç‰©æœ‰æ˜é¡¯çš„ 3D æ—‹è½‰æˆ–è¦–è§’è®ŠåŒ–ã€‚</li>
</ul>
<hr />
<h2>âœ… è©³ç´°éœ€æ±‚åˆ—è¡¨</h2>
<h3>éœ€æ±‚ 1ï¼šç’°å¢ƒæº–å‚™</h3>
<p><strong>èªªæ˜</strong>ï¼šåŒ¯å…¥å¥—ä»¶ï¼Œä¸¦å»ºç«‹ä¸€å€‹åŒ…å«å¤šå€‹ç›®æ¨™é“å…·çš„æ¨¡æ“¬éŠæˆ²ç•«é¢ï¼Œä»¥åŠä¸€å€‹é“å…·æ¨¡æ¿ã€‚</p>
<p><strong>ç¨‹å¼ç¢¼æç¤º</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">google.colab.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">cv2_imshow</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">éŠæˆ²ç•«é¢é“å…·å®šä½ç³»çµ±</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>

<span class="c1"># å»ºç«‹æ¨¡æ“¬éŠæˆ²ç•«é¢èˆ‡æ¨¡æ¿</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_test_images</span><span class="p">():</span>
    <span class="n">game_screen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">);</span> <span class="n">game_screen</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">potion_icon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">);</span> <span class="n">potion_icon</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">potion_icon</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="c1"># åœ¨å¤šå€‹ä½ç½®æ”¾ç½®åœ–ç¤ºï¼ŒåŒ…å«ä¸€å€‹è¼•å¾®é‡ç–Šçš„ç‹€æ³ï¼Œä»¥æ¸¬è©¦å¾ŒçºŒè™•ç†</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span> <span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">160</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span> <span class="n">game_screen</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">50</span><span class="p">]</span> <span class="o">=</span> <span class="n">potion_icon</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;game_screen.png&#39;</span><span class="p">,</span> <span class="n">game_screen</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;template_potion.png&#39;</span><span class="p">,</span> <span class="n">potion_icon</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ“ æ¸¬è©¦åœ–ç‰‡ &#39;game_screen.png&#39; èˆ‡ &#39;template_potion.png&#39; å»ºç«‹å®Œæˆ&quot;</span><span class="p">)</span>

<span class="n">create_test_images</span><span class="p">()</span>
</code></pre></div>

<hr />
<h3>éœ€æ±‚ 2ï¼šè®€å–åœ–ç‰‡èˆ‡åŸ·è¡Œæ¨¡æ¿åŒ¹é…</h3>
<p><strong>èªªæ˜</strong>ï¼šè®€å–ä¸»ç•«é¢èˆ‡æ¨¡æ¿ï¼Œä¸¦ä½¿ç”¨ <code>cv2.matchTemplate</code> åŸ·è¡ŒåŒ¹é…ã€‚æ­¤å‡½æ•¸æœƒç”¨æ¨¡æ¿åœ¨ä¸»ç•«é¢ä¸Šæ»‘å‹•æ¯”å°ï¼Œç”Ÿæˆä¸€å¼µã€Œç†±åŠ›åœ– (heatmap)ã€ï¼Œåœ–ä¸­è¶Šäº®çš„ä½ç½®ä»£è¡¨èˆ‡æ¨¡æ¿çš„ç›¸ä¼¼åº¦è¶Šé«˜ã€‚</p>
<p><strong>ç¨‹å¼ç¢¼æç¤º</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">img_rgb</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;game_screen.png&#39;</span><span class="p">)</span>
<span class="n">img_gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;template_potion.png&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ åœ–ç‰‡è®€å–æˆåŠŸï¼Œæ¨¡æ¿å°ºå¯¸: </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">h</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># åŸ·è¡Œæ¨¡æ¿åŒ¹é…ã€‚TM_CCOEFF_NORMED æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€å€‹æ¨™æº–åŒ–çš„ç›¸é—œä¿‚æ•¸ï¼Œ</span>
<span class="c1"># çµæœä»‹æ–¼ -1.0 åˆ° 1.0 ä¹‹é–“ï¼Œ1.0 ä»£è¡¨å®Œç¾åŒ¹é…ã€‚</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">matchTemplate</span><span class="p">(</span><span class="n">img_gray</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">TM_CCOEFF_NORMED</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;åŒ¹é…çµæœç†±åŠ›åœ– (è¶Šäº®ä»£è¡¨è¶Šå¯èƒ½åŒ¹é…)ï¼š&quot;</span><span class="p">)</span>
<span class="c1"># ç‚ºäº†æ–¹ä¾¿è§€å¯Ÿï¼Œæˆ‘å€‘å°‡ç†±åŠ›åœ–çš„ç°éšå€¼ç¯„åœæ‹‰ä¼¸åˆ° 0-255</span>
<span class="n">res_visual</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">NORM_MINMAX</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_8U</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">res_visual</span><span class="p">)</span>
</code></pre></div>

<hr />
<h3>éœ€æ±‚ 3ï¼šç¯©é¸é«˜ç›¸ä¼¼åº¦ä½ç½®</h3>
<p><strong>èªªæ˜</strong>ï¼šä½¿ç”¨ <code>np.where</code> æ­é…é–¾å€¼ (threshold) å¾ç†±åŠ›åœ–ä¸­ç¯©é¸å‡ºæ‰€æœ‰ç›¸ä¼¼åº¦è¶³å¤ é«˜çš„é»ã€‚</p>
<p><strong>ç¨‹å¼ç¢¼æç¤º</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="c1"># è¨­å®šä¿¡è³´åº¦é–¾å€¼</span>
<span class="n">loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">loc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># å°‡ (y,x) åº§æ¨™è½‰æ›ç‚º (x,y) æ ¼å¼</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âœ“ ä½¿ç”¨é–¾å€¼ </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2"> æ‰¾åˆ° </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="si">}</span><span class="s2"> å€‹åŸå§‹åŒ¹é…é»&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h3>éœ€æ±‚ 4ï¼šè™•ç†é‡ç–Šçš„åµæ¸¬æ¡† (ç°¡åŒ–ç‰ˆ NMS)</h3>
<p><strong>èªªæ˜</strong>ï¼šå–®ä¸€ç›®æ¨™å‘¨åœå¸¸æœ‰å¤šå€‹é»çš„åŒ¹é…å€¼éƒ½é«˜æ–¼é–¾å€¼ï¼Œå°è‡´åµæ¸¬æ¡†é‡ç–Šã€‚æˆ‘å€‘éœ€è¦å°‡é€™äº›å¯†é›†çš„é»ç¾¤çµ„åˆä½µï¼Œåªä¿ç•™ä¸€å€‹æœ€å…·ä»£è¡¨æ€§çš„ä¸­å¿ƒé»ã€‚é€™å€‹éç¨‹æ˜¯<strong>éæ¥µå¤§å€¼æŠ‘åˆ¶ (Non-Maximum Suppression, NMS)</strong> çš„ç°¡åŒ–ç‰ˆã€‚</p>
<p><strong>ç¨‹å¼ç¢¼æç¤º</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">group_rectangles</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">group_threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">points</span><span class="p">:</span> <span class="k">return</span> <span class="p">[]</span>
    <span class="n">points</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">grouped_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">current_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
        <span class="n">dist_x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_group</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dist_y</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_group</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dist_x</span> <span class="o">&lt;</span> <span class="n">group_threshold</span> <span class="ow">and</span> <span class="n">dist_y</span> <span class="o">&lt;</span> <span class="n">group_threshold</span><span class="p">:</span>
            <span class="n">current_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">avg_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]))</span>
            <span class="n">avg_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]))</span>
            <span class="n">grouped_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">avg_x</span><span class="p">,</span> <span class="n">avg_y</span><span class="p">))</span>
            <span class="n">current_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="c1"># è™•ç†æœ€å¾Œä¸€å€‹ç¾¤çµ„</span>
    <span class="n">avg_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]))</span>
    <span class="n">avg_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]))</span>
    <span class="n">grouped_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">avg_x</span><span class="p">,</span> <span class="n">avg_y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">grouped_points</span>

<span class="n">grouped_points</span> <span class="o">=</span> <span class="n">group_rectangles</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ“ ç¶“éé‡ç–Šè™•ç†ï¼Œæœ€çµ‚ç¢ºèª </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped_points</span><span class="p">)</span><span class="si">}</span><span class="s2"> å€‹ç¨ç«‹ç›®æ¨™</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h3>éœ€æ±‚ 5ï¼šæ¨™è¨˜èˆ‡é¡¯ç¤ºçµæœ</h3>
<p><strong>èªªæ˜</strong>ï¼šåœ¨åŸå§‹å½©è‰²åœ–ç‰‡ä¸Šï¼Œæ ¹æ“šè™•ç†å¾Œçš„åº§æ¨™é»ç¹ªè£½çŸ©å½¢æ¡†ï¼Œæ¨™ç¤ºå‡ºæ‰€æœ‰æ‰¾åˆ°çš„ç›®æ¨™ã€‚</p>
<p><strong>ç¨‹å¼ç¢¼æç¤º</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">img_result</span> <span class="o">=</span> <span class="n">img_rgb</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grouped_points</span><span class="p">):</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">img_result</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">img_result</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">20</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ç›®æ¨™ </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: ä½ç½® (</span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">åŸå§‹éŠæˆ²ç•«é¢ï¼š&quot;</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">æ¨™è¨˜å¾Œçš„çµæœï¼š&quot;</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">img_result</span><span class="p">)</span>

<span class="n">output_filename</span> <span class="o">=</span> <span class="s1">&#39;result_template_matching.png&#39;</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="n">img_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">âœ“ çµæœå·²å„²å­˜ç‚º </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2>ğŸ“ å®Œæ•´å¯åŸ·è¡Œç¨‹å¼ç¢¼</h2>
<div class="codehilite"><pre><span></span><code><span class="c1"># ========================================</span>
<span class="c1"># é¡Œç›®å››ï¼šéŠæˆ²ç•«é¢é“å…·å®šä½ç³»çµ± (v2)</span>
<span class="c1"># ========================================</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">google.colab.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">cv2_imshow</span>

<span class="c1"># === 1. ç’°å¢ƒæº–å‚™ ===</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_test_images</span><span class="p">():</span>
    <span class="n">game_screen</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">);</span> <span class="n">game_screen</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">potion_icon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">);</span> <span class="n">potion_icon</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">putText</span><span class="p">(</span><span class="n">potion_icon</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">cv2</span><span class="o">.</span><span class="n">FONT_HERSHEY_SIMPLEX</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span> <span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">160</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span> <span class="n">game_screen</span><span class="p">[</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">50</span><span class="p">]</span> <span class="o">=</span> <span class="n">potion_icon</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;game_screen.png&#39;</span><span class="p">,</span> <span class="n">game_screen</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;template_potion.png&#39;</span><span class="p">,</span> <span class="n">potion_icon</span><span class="p">)</span>
<span class="n">create_test_images</span><span class="p">()</span>

<span class="c1"># === 2. è®€å–èˆ‡åŒ¹é… ===</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;game_screen.png&#39;</span><span class="p">)</span>
<span class="n">img_gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;template_potion.png&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">matchTemplate</span><span class="p">(</span><span class="n">img_gray</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">TM_CCOEFF_NORMED</span><span class="p">)</span>

<span class="c1"># === 3. ç¯©é¸èˆ‡ç¾¤çµ„ ===</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">loc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">group_rectangles</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">group_threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">points</span><span class="p">:</span> <span class="k">return</span> <span class="p">[]</span>
    <span class="n">points</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">grouped_points</span><span class="p">,</span> <span class="n">current_group</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)):</span>
        <span class="n">dist_x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_group</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dist_y</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_group</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dist_x</span> <span class="o">&lt;</span> <span class="n">group_threshold</span> <span class="ow">and</span> <span class="n">dist_y</span> <span class="o">&lt;</span> <span class="n">group_threshold</span><span class="p">:</span>
            <span class="n">current_group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">avg_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]));</span> <span class="n">avg_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]))</span>
            <span class="n">grouped_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">avg_x</span><span class="p">,</span> <span class="n">avg_y</span><span class="p">))</span>
            <span class="n">current_group</span> <span class="o">=</span> <span class="p">[</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">avg_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]));</span> <span class="n">avg_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">current_group</span><span class="p">]))</span>
    <span class="n">grouped_points</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">avg_x</span><span class="p">,</span> <span class="n">avg_y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">grouped_points</span>

<span class="n">grouped_points</span> <span class="o">=</span> <span class="n">group_rectangles</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;æ‰¾åˆ° </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grouped_points</span><span class="p">)</span><span class="si">}</span><span class="s2"> å€‹ç¨ç«‹ç›®æ¨™</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># === 4. æ¨™è¨˜èˆ‡é¡¯ç¤º ===</span>
<span class="n">img_result</span> <span class="o">=</span> <span class="n">img_rgb</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grouped_points</span><span class="p">):</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">img_result</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ç›®æ¨™ </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: ä½ç½® (</span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">æ¨™è¨˜å¾Œçš„çµæœï¼š&quot;</span><span class="p">)</span>
<span class="n">cv2_imshow</span><span class="p">(</span><span class="n">img_result</span><span class="p">)</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="s1">&#39;result_template_matching.png&#39;</span><span class="p">,</span> <span class="n">img_result</span><span class="p">)</span>
</code></pre></div>

<hr />
<h2>ğŸ”§ é™¤éŒ¯èˆ‡é€²éšæŠ€å·§</h2>
<h3>å•é¡Œ 1ï¼šæ‰¾ä¸åˆ°ç›®æ¨™æˆ–èª¤åˆ¤å¤ªå¤š</h3>
<p><strong>è§£æ³•</strong>ï¼šé—œéµåœ¨æ–¼èª¿æ•´ <code>threshold</code>ã€‚<br />
-   <strong>æ‰¾ä¸åˆ°ç›®æ¨™</strong>ï¼šé€æ­¥<strong>é™ä½</strong> <code>threshold</code> (ä¾‹å¦‚ <code>0.9</code> -&gt; <code>0.8</code> -&gt; <code>0.7</code>)ã€‚åŸå› å¯èƒ½æ˜¯åœ–ç‰‡å£“ç¸®ã€å¾®å°ç‰¹æ•ˆå°è‡´ç„¡æ³•å®Œç¾åŒ¹é…ã€‚<br />
-   <strong>èª¤åˆ¤å¤ªå¤š</strong>ï¼šé€æ­¥<strong>æé«˜</strong> <code>threshold</code> (ä¾‹å¦‚ <code>0.8</code> -&gt; <code>0.9</code> -&gt; <code>0.95</code>)ã€‚åŸå› å¯èƒ½æ˜¯æ¨¡æ¿å¤ªç°¡å–®ï¼Œå®¹æ˜“åœ¨èƒŒæ™¯ä¸­æ‰¾åˆ°ç›¸ä¼¼å€åŸŸã€‚</p>
<h3>æŒ‘æˆ° 1ï¼šå¤šå°ºåº¦æ¨¡æ¿åŒ¹é…</h3>
<p><strong>å•é¡Œ</strong>ï¼šå¦‚æœç›®æ¨™ç‰©å¤§å°æœƒè®ŠåŒ–æ€éº¼è¾¦ï¼Ÿ<br />
<strong>è§£æ³•</strong>ï¼šå°‡æ¨¡æ¿ç¸®æ”¾æˆå¤šç¨®å°ºå¯¸ï¼Œå°æ¯å€‹å°ºå¯¸éƒ½é€²è¡Œä¸€æ¬¡æ¨¡æ¿åŒ¹é…ï¼Œæœ€å¾ŒåŒ¯ç¸½çµæœã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># ç¯„ä¾‹ï¼šåœ¨ 80% åˆ° 120% çš„å°ºå¯¸ç¯„åœå…§æœç´¢</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="n">resized_template</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">scale</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)))</span>
    <span class="c1"># ... åŸ·è¡Œ matchTemplate ä¸¦ä¿å­˜çµæœ ...</span>
</code></pre></div>

<h3>æŒ‘æˆ° 2ï¼šé®ç½©åŒ¹é… (Mask Matching)</h3>
<p><strong>å•é¡Œ</strong>ï¼šå¦‚æœæ¨¡æ¿æ˜¯ä¸è¦å‰‡å½¢ç‹€ï¼ˆä¾‹å¦‚åœ“å½¢è—¥æ°´ï¼‰ï¼Œå¦‚ä½•å¿½ç•¥çŸ©å½¢æ¡†ä¸­çš„èƒŒæ™¯ï¼Ÿ<br />
<strong>è§£æ³•</strong>ï¼šç‚ºæ¨¡æ¿å»ºç«‹ä¸€å€‹äºŒå€¼åŒ–çš„é®ç½© (mask)ï¼Œåœ¨åŒ¹é…æ™‚å‚³å…¥ <code>mask</code> åƒæ•¸ï¼ŒOpenCV å°±æœƒåªæ¯”å°é®ç½©ç‚ºç™½è‰²çš„å€åŸŸã€‚</p>
<hr />
<h2>ğŸ“š å­¸ç¿’è³‡æº</h2>
<ul>
<li>OpenCV å®˜æ–¹æ–‡ä»¶ï¼š<a href="https://docs.opencv.org/4.x/d4/dc6/tutorial_py_template_matching.html">Template Matching</a></li>
<li>PyImageSearch æ•™å­¸ (å«å¤šå°ºåº¦åŒ¹é…)ï¼š<a href="https://pyimagesearch.com/2021/03/22/opencv-template-matching-cv2-matchtemplate/">OpenCV Template Matching</a></li>
</ul>
<div class="codehilite"><pre><span></span><code>
</code></pre></div></div>
    
    <!-- Highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            "startOnLoad": true,
            "theme": "dark",
            "securityLevel": "loose"
});
    </script>
</body>
</html>