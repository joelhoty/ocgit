<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>proposal_interaction_modes</title>
    
    <!-- CSS æ¡†æ¶ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.min.css">
    
    <!-- ä»£ç¢¼é«˜äº® -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/base16/darcula.min.css">
    
    <!-- è‡ªå®šç¾©æ¨£å¼ -->
    <style>
        
                body {
                    max-width: 900px;
                    margin: 0 auto;
                    padding: 20px;
                }
                /* æå‡ä»£ç å—å¯¹æ¯”åº¦ */
                pre {
                    background: #1e1e1e !important;
                    border: 1px solid #3e3e3e;
                }
                pre code {
                    background: #1e1e1e !important;
                }
                code {
                    background: #2d2d2d !important;
                }
                /* å¼•ç”¨å—å¯¹æ¯”åº¦ */
                blockquote {
                    background: #2d2d2d;
                    border-left: 4px solid #4a9eff;
                }
            
        
        /* é€šç”¨ä»£ç¢¼å¡Šæ¨£å¼ */
        pre code {
            display: block;
            padding: 1.5em;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.6;
        }

        /* Mermaid åœ–è¡¨æ¨£å¼ */
        
        .mermaid {
            margin: 2em 0;
            padding: 1.5em;
            text-align: center;
            border-radius: 8px;
        }
        
        .mermaid {
            background: #2c3034;
            border: 1px solid #444;
        }
            
        
        /* éŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container, .markdown-body, .latex-body, .window-body, .nes-container {
                padding: 15px;
            }
            pre code {
                padding: 1em;
            }
        }
        
        
    </style>
</head>
<body>
    <div class="container"><h1>å››ç¨®ä½¿ç”¨è€…äº’å‹•æ¨¡å¼</h1>
<blockquote>
<p>è¿”å› <a href="./proposal_all.html">ä¸»æ–‡ä»¶</a></p>
</blockquote>
<p>æœ¬æ–‡ä»¶è©³ç´°èªªæ˜ç³»çµ±æä¾›çš„å››ç¨®æ ¸å¿ƒäº’å‹•æ¨¡å¼ï¼Œæ¯ç¨®æ¨¡å¼é‡å°ä¸åŒçš„ä½¿ç”¨è€…éœ€æ±‚èˆ‡ä½¿ç”¨å ´æ™¯è¨­è¨ˆã€‚</p>
<hr />
<h2>äº’å‹•æ¨¡å¼ç¸½è¦½</h2>
<table>
<thead>
<tr>
<th>æ¨¡å¼</th>
<th>ç›®æ¨™ä½¿ç”¨è€…</th>
<th>äº’å‹•æ–¹å¼</th>
<th>æª¢æ¸¬è§¸ç™¼ä¾†æº</th>
<th>å­¸ç¿’æ€§</th>
<th>è‡ªå‹•åŒ–ç¨‹åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æ¨¡å¼ä¸€ï¼šå¼•å°å¼æƒæ</strong></td>
<td>åˆå­¸è€…ã€é–‹ç™¼äººå“¡</td>
<td>é¸å–®å¼é¸æ“‡</td>
<td>ä½¿ç”¨è€…ä¸»å‹•é¸æ“‡</td>
<td>ä¸­</td>
<td>ä½</td>
</tr>
<tr>
<td><strong>æ¨¡å¼äºŒï¼šæƒ…è³‡é©…å‹•æƒæ</strong></td>
<td>æ‰€æœ‰ä½¿ç”¨è€…</td>
<td>æ™ºæ…§å»ºè­°</td>
<td>ç³»çµ±åˆ†æå¾Œæ¨è–¦</td>
<td>ä¸­é«˜</td>
<td>ä¸­</td>
</tr>
<tr>
<td><strong>æ¨¡å¼ä¸‰ï¼šå°è©±å¼æƒæ</strong></td>
<td>å­¸ç¿’å°å‘ä½¿ç”¨è€…</td>
<td>è‡ªç„¶èªè¨€å°è©±</td>
<td>å°è©±è¨è«–å¾Œæ±ºå®š</td>
<td>é«˜</td>
<td>ä½</td>
</tr>
<tr>
<td><strong>æ¨¡å¼å››ï¼šå…¨è‡ªå‹•åŒ–æƒæ</strong></td>
<td>ä¼æ¥­ç”¨æˆ¶ã€å°ˆæ¥­äººå£«</td>
<td>ä¸€éµåŸ·è¡Œ</td>
<td>é è¨­ç­–ç•¥</td>
<td>ä½</td>
<td>é«˜</td>
</tr>
</tbody>
</table>
<hr />
<h2>æ¨¡å¼ä¸€ï¼šå¼•å°å¼æƒæ (Guided Scan)</h2>
<h3>è¨­è¨ˆç†å¿µ</h3>
<p><strong>ç‚ºä¸ç†Ÿæ‚‰è³‡å®‰æ¦‚å¿µçš„ä½¿ç”¨è€…æä¾›æ¸…æ™°çš„æª¢æ¸¬é¸å–®ï¼Œå°‡è¤‡é›œçš„æŠ€è¡“æ¦‚å¿µè½‰åŒ–ç‚ºç›´è§€çš„é¸é …ã€‚</strong></p>
<h3>é©ç”¨å ´æ™¯</h3>
<ul>
<li>é–‹ç™¼äººå“¡æƒ³åœ¨éƒ¨ç½²å‰å¿«é€Ÿæª¢æŸ¥å¸¸è¦‹å®‰å…¨å•é¡Œ</li>
<li>è³‡å®‰åˆå­¸è€…æƒ³å˜—è©¦å¯¦éš›çš„æ¼æ´æª¢æ¸¬</li>
<li>éœ€è¦é‡å°ç‰¹å®šè­°é¡Œï¼ˆå¦‚ SQL Injectionï¼‰é€²è¡Œæ¸¬è©¦</li>
</ul>
<h3>äº’å‹•æµç¨‹</h3>
<pre class="codehilite"><code>[æ­¥é©Ÿ 1] ä½¿ç”¨è€…è¼¸å…¥ç›®æ¨™ URL
    â†“
[æ­¥é©Ÿ 2] ç³»çµ±é¡¯ç¤ºæª¢æ¸¬é …ç›®é¸å–®
    â†“
[æ­¥é©Ÿ 3] ä½¿ç”¨è€…é¸æ“‡ä¸€å€‹æˆ–å¤šå€‹é …ç›®
    â†“
[æ­¥é©Ÿ 4] ç³»çµ±åŸ·è¡Œå°æ‡‰çš„æª¢æ¸¬è…³æœ¬
    â†“
[æ­¥é©Ÿ 5] å‘ˆç¾çµæœèˆ‡è§£é‡‹
</code></pre>

<h3>UI è¨­è¨ˆæ¦‚å¿µ</h3>
<h4>ä¸»ç•«é¢ï¼šæª¢æ¸¬é …ç›®é¸å–®</h4>
<pre class="codehilite"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¯ å¼•å°å¼æƒæ - è«‹é¸æ“‡æª¢æ¸¬é …ç›®                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ğŸ“Š åŸºç¤è³‡è¨Šç›¤é»                                â”‚
â”‚  â””â”€ è­˜åˆ¥ä¼ºæœå™¨é¡å‹ã€é–‹æ”¾é€£æ¥åŸ ã€ä½¿ç”¨çš„æŠ€è¡“      â”‚
â”‚     å·¥å…·ï¼šnmap, curl, WhatWeb                   â”‚
â”‚     é ä¼°æ™‚é–“ï¼š2-3 åˆ†é˜                           â”‚
â”‚     [ é¸æ“‡ ]                                     â”‚
â”‚                                                 â”‚
â”‚  ğŸ”’ SSL/TLS å®‰å…¨æ€§æª¢æŸ¥                          â”‚
â”‚  â””â”€ æª¢æ¸¬æ†‘è­‰æœ‰æ•ˆæ€§ã€åŠ å¯†å”å®šå¼·åº¦ã€å·²çŸ¥å¼±é»      â”‚
â”‚     å·¥å…·ï¼šSSLyze, testssl.sh                    â”‚
â”‚     é ä¼°æ™‚é–“ï¼š3-5 åˆ†é˜                           â”‚
â”‚     [ é¸æ“‡ ]                                     â”‚
â”‚                                                 â”‚
â”‚  ğŸ›¡ï¸ Web ä¼ºæœå™¨å·²çŸ¥æ¼æ´æƒæ                      â”‚
â”‚  â””â”€ æƒæ CVE è³‡æ–™åº«ä¸­èˆ‡ç›®æ¨™ç‰ˆæœ¬ç›¸é—œçš„å·²çŸ¥æ¼æ´   â”‚
â”‚     å·¥å…·ï¼šNikto, CVE Search                     â”‚
â”‚     é ä¼°æ™‚é–“ï¼š5-10 åˆ†é˜                          â”‚
â”‚     [ é¸æ“‡ ]                                     â”‚
â”‚                                                 â”‚
â”‚  ğŸ’‰ SQL Injection æª¢æ¸¬                          â”‚
â”‚  â””â”€ è‡ªå‹•æ¸¬è©¦è¼¸å…¥é»æ˜¯å¦å­˜åœ¨ SQL æ³¨å…¥æ¼æ´         â”‚
â”‚     å·¥å…·ï¼šSQLMap                                â”‚
â”‚     é ä¼°æ™‚é–“ï¼š10-15 åˆ†é˜                         â”‚
â”‚     [ é¸æ“‡ ]                                     â”‚
â”‚                                                 â”‚
â”‚  ğŸ” æ•æ„Ÿè³‡è¨Šæ´©æ¼æª¢æ¸¬                            â”‚
â”‚  â””â”€ æª¢æŸ¥æ˜¯å¦æš´éœ²è¨­å®šæª”ã€å‚™ä»½æª”ã€ç›®éŒ„åˆ—è¡¨ç­‰      â”‚
â”‚     å·¥å…·ï¼šGoBuster, è‡ªè¨‚è…³æœ¬                    â”‚
â”‚     é ä¼°æ™‚é–“ï¼š5-8 åˆ†é˜                           â”‚
â”‚     [ é¸æ“‡ ]                                     â”‚
â”‚                                                 â”‚
â”‚  ğŸ“ CMS å°ˆç”¨æƒæ (WordPress/Joomla/Drupal)      â”‚
â”‚  â””â”€ é‡å°å¸¸è¦‹ CMS çš„å°ˆé–€æª¢æ¸¬                     â”‚
â”‚     å·¥å…·ï¼šWPScan, JoomScan                      â”‚
â”‚     é ä¼°æ™‚é–“ï¼š8-12 åˆ†é˜                          â”‚
â”‚     [ é¸æ“‡ ]                                     â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·²é¸æ“‡ï¼š3 é … | é ä¼°ç¸½æ™‚é–“ï¼š10-18 åˆ†é˜          â”‚
â”‚                              [ å–æ¶ˆ ] [ é–‹å§‹æƒæ ]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3>æª¢æ¸¬é …ç›®è³‡æ–™çµæ§‹</h3>
<p>æ¯å€‹æª¢æ¸¬é …ç›®åœ¨å¾Œç«¯ä»¥çµæ§‹åŒ–æ–¹å¼å®šç¾©ï¼š</p>
<pre class="codehilite"><code class="language-python">from pydantic import BaseModel

class GuidedScanItem(BaseModel):
    id: str  # ä¾‹å¦‚ï¼š&quot;basic_info_gathering&quot;
    title: str  # &quot;åŸºç¤è³‡è¨Šç›¤é»&quot;
    description: str
    icon: str  # Emoji æˆ–åœ–ç¤ºåç¨±
    tools: list[str]  # [&quot;nmap&quot;, &quot;curl&quot;, &quot;whatweb&quot;]
    estimated_duration_min: int
    estimated_duration_max: int
    difficulty: str  # &quot;beginner&quot; | &quot;intermediate&quot; | &quot;advanced&quot;
    learning_goals: list[str]  # å­¸ç¿’ç›®æ¨™
    prompt_template: str  # LLM Prompt æ¨¡æ¿

# ç¯„ä¾‹å¯¦ä¾‹
BASIC_INFO_GATHERING = GuidedScanItem(
    id=&quot;basic_info_gathering&quot;,
    title=&quot;åŸºç¤è³‡è¨Šç›¤é»&quot;,
    description=&quot;è­˜åˆ¥ä¼ºæœå™¨é¡å‹ã€é–‹æ”¾é€£æ¥åŸ ã€ä½¿ç”¨çš„æŠ€è¡“&quot;,
    icon=&quot;ğŸ“Š&quot;,
    tools=[&quot;nmap&quot;, &quot;curl&quot;, &quot;whatweb&quot;],
    estimated_duration_min=2,
    estimated_duration_max=3,
    difficulty=&quot;beginner&quot;,
    learning_goals=[
        &quot;äº†è§£ä»€éº¼æ˜¯é€£æ¥åŸ æƒæ&quot;,
        &quot;å­¸ç¿’å¦‚ä½•è­˜åˆ¥ Web ä¼ºæœå™¨ç‰ˆæœ¬&quot;,
        &quot;ç†è§£è³‡è¨Šæ”¶é›†åœ¨æ»²é€æ¸¬è©¦ä¸­çš„é‡è¦æ€§&quot;
    ],
    prompt_template=&quot;&quot;&quot;
    As a senior penetration tester, create a comprehensive information gathering script for {target}.

    Tasks:
    1. Use nmap to scan common web ports (80, 443, 8080, 8443)
    2. Use curl to fetch HTTP headers and identify server software
    3. Use WhatWeb to identify CMS and technologies

    Output a JSON with:
    - open_ports: list of dicts with port, protocol, service
    - server_info: dict with server type, version
    - technologies: list of identified technologies
    &quot;&quot;&quot;
)
</code></pre>

<h3>åŸ·è¡Œéç¨‹çš„å³æ™‚åé¥‹</h3>
<pre class="codehilite"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ æ­£åœ¨åŸ·è¡Œï¼šåŸºç¤è³‡è¨Šç›¤é»                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… [1/3] nmap é€£æ¥åŸ æƒæ                        â”‚
â”‚     ç™¼ç¾ 2 å€‹é–‹æ”¾é€£æ¥åŸ                          â”‚
â”‚                                                 â”‚
â”‚  ğŸ”„ [2/3] curl HTTP Header åˆ†æ                 â”‚
â”‚     æ­£åœ¨æ“·å–ä¼ºæœå™¨è³‡è¨Š...                       â”‚
â”‚                                                 â”‚
â”‚  â³ [3/3] WhatWeb æŠ€è¡“è­˜åˆ¥                      â”‚
â”‚     ç­‰å¾…ä¸­...                                   â”‚
â”‚                                                 â”‚
â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] 65%                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3>çµæœå‘ˆç¾</h3>
<p>çµæœé é¢åŒ…å«ä¸‰å€‹å±¤æ¬¡çš„è³‡è¨Šï¼š</p>
<p><strong>å±¤æ¬¡ 1ï¼šåŸ·è¡Œæ‘˜è¦</strong>ï¼ˆé©åˆå¿«é€Ÿç€è¦½ï¼‰</p>
<pre class="codehilite"><code>ğŸ“Š åŸºç¤è³‡è¨Šç›¤é» - å®Œæˆ

ğŸ” ç™¼ç¾ï¼š
- é–‹æ”¾é€£æ¥åŸ ï¼š2 å€‹ (80, 443)
- ä¼ºæœå™¨é¡å‹ï¼šApache 2.4.49
- å·²è­˜åˆ¥æŠ€è¡“ï¼šPHP 7.4, WordPress 5.8

âš ï¸ é¢¨éšªæç¤ºï¼š
- Apache 2.4.49 å­˜åœ¨å·²çŸ¥æ¼æ´ (CVE-2021-41773)
- å»ºè­°åŸ·è¡Œã€ŒWeb ä¼ºæœå™¨å·²çŸ¥æ¼æ´æƒæã€é€²è¡Œæ·±å…¥æª¢æ¸¬
</code></pre>

<p><strong>å±¤æ¬¡ 2ï¼šè©³ç´°ç™¼ç¾</strong>ï¼ˆé»æ“Šå±•é–‹ï¼‰</p>
<pre class="codehilite"><code class="language-json">{
  &quot;open_ports&quot;: [
    {
      &quot;port&quot;: 80,
      &quot;protocol&quot;: &quot;tcp&quot;,
      &quot;service&quot;: &quot;http&quot;,
      &quot;version&quot;: &quot;Apache httpd 2.4.49&quot;
    },
    {
      &quot;port&quot;: 443,
      &quot;protocol&quot;: &quot;tcp&quot;,
      &quot;service&quot;: &quot;https&quot;,
      &quot;version&quot;: &quot;Apache httpd 2.4.49&quot;
    }
  ],
  &quot;server_info&quot;: {
    &quot;type&quot;: &quot;Apache&quot;,
    &quot;version&quot;: &quot;2.4.49&quot;,
    &quot;os&quot;: &quot;Unix&quot;
  },
  &quot;technologies&quot;: [
    &quot;PHP 7.4.3&quot;,
    &quot;WordPress 5.8&quot;,
    &quot;MySQL&quot;
  ]
}
</code></pre>

<p><strong>å±¤æ¬¡ 3ï¼šåŸå§‹å·¥å…·è¼¸å‡º</strong>ï¼ˆä¾›é€²éšä½¿ç”¨è€…åƒè€ƒï¼‰</p>
<pre class="codehilite"><code>[nmap åŸå§‹è¼¸å‡º]
Starting Nmap 7.92 ( https://nmap.org ) at 2025-01-15 14:30 UTC
Nmap scan report for target.com (203.0.113.10)
Host is up (0.050s latency).
PORT    STATE SERVICE VERSION
80/tcp  open  http    Apache httpd 2.4.49 ((Unix))
443/tcp open  https   Apache httpd 2.4.49 ((Unix))
...
</code></pre>

<hr />
<h2>æ¨¡å¼äºŒï¼šæƒ…è³‡é©…å‹•æƒæ (Intelligence-Driven Scan)</h2>
<h3>è¨­è¨ˆç†å¿µ</h3>
<p><strong>åˆ©ç”¨ CVE è³‡æ–™åº«èˆ‡è³‡å®‰æƒ…è³‡ï¼Œä¸»å‹•ç‚ºä½¿ç”¨è€…æ¨è–¦ç›¸é—œçš„å®‰å…¨æª¢æ¸¬ï¼Œå¾ã€Œè¢«å‹•åŸ·è¡Œã€åˆ°ã€Œä¸»å‹•å»ºè­°ã€ã€‚</strong></p>
<h3>é©ç”¨å ´æ™¯</h3>
<ul>
<li>ä½¿ç”¨è€…ä¸ç¢ºå®šæ‡‰è©²æª¢æ¸¬ä»€éº¼</li>
<li>å¸Œæœ›é‡å°ç›®æ¨™çš„å¯¦éš›ç’°å¢ƒé€²è¡Œå„ªåŒ–æª¢æ¸¬</li>
<li>æƒ³äº†è§£ã€Œæˆ‘çš„ç¶²ç«™å¯èƒ½é¢è‡¨å“ªäº›å·²çŸ¥å¨è„…ã€</li>
</ul>
<h3>äº’å‹•æµç¨‹</h3>
<pre class="codehilite"><code>[æ­¥é©Ÿ 1] ä½¿ç”¨è€…è¼¸å…¥ç›®æ¨™ URL
    â†“
[æ­¥é©Ÿ 2] ç³»çµ±åŸ·è¡Œå¿«é€Ÿåµå¯Ÿ
    - nmap å¿«é€Ÿæƒæ
    - HTTP Header åˆ†æ
    - æŠ€è¡“æ£§è­˜åˆ¥
    â†“
[æ­¥é©Ÿ 3] æ¯”å° CVE è³‡æ–™åº«
    - æ ¹æ“šè­˜åˆ¥çš„è»Ÿé«”ç‰ˆæœ¬æŸ¥è©¢å·²çŸ¥æ¼æ´
    â†“
[æ­¥é©Ÿ 4] ç”Ÿæˆæ™ºæ…§å»ºè­°æ¸…å–®
    â†“
[æ­¥é©Ÿ 5] ä½¿ç”¨è€…é¸æ“‡è¦æ¸¬è©¦çš„ CVE
    â†“
[æ­¥é©Ÿ 6] LLM ç”Ÿæˆå°ˆç”¨çš„æ¼æ´é©—è­‰è…³æœ¬
    â†“
[æ­¥é©Ÿ 7] åŸ·è¡Œä¸¦å‘ˆç¾çµæœ
</code></pre>

<h3>UI è¨­è¨ˆæ¦‚å¿µ</h3>
<h4>æ™ºæ…§å»ºè­°ç•«é¢</h4>
<pre class="codehilite"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§  æƒ…è³‡é©…å‹•æƒæ - æ™ºæ…§å»ºè­°                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç›®æ¨™ï¼šhttps://example.com                      â”‚
â”‚  å¿«é€Ÿåµå¯Ÿå®Œæˆ (3.2 ç§’)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ğŸ“Œ å·²è­˜åˆ¥æŠ€è¡“æ£§ï¼š                              â”‚
â”‚  â”œâ”€ Apache HTTP Server 2.4.49                  â”‚
â”‚  â”œâ”€ PHP 7.4.3                                   â”‚
â”‚  â”œâ”€ WordPress 5.8                               â”‚
â”‚  â””â”€ OpenSSL 1.1.1d                              â”‚
â”‚                                                 â”‚
â”‚  âš ï¸ ç™¼ç¾ 5 å€‹ç›¸é—œçš„å·²çŸ¥æ¼æ´ (CVE)                â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ğŸ”´ Critical - CVE-2021-41773                   â”‚
â”‚  å½±éŸ¿çµ„ä»¶ï¼šApache HTTP Server 2.4.49           â”‚
â”‚  æ¼æ´é¡å‹ï¼šè·¯å¾‘ç©¿è¶Š (Path Traversal)            â”‚
â”‚  CVSS è©•åˆ†ï¼š9.8 / 10.0                          â”‚
â”‚                                                 â”‚
â”‚  ğŸ“ æ¼æ´èªªæ˜ï¼š                                   â”‚
â”‚  Apache 2.4.49 çš„ URL æ­£è¦åŒ–è™•ç†å­˜åœ¨ç¼ºé™·ï¼Œæ”»æ“Šè€… â”‚
â”‚  å¯é€éç‰¹è£½çš„è«‹æ±‚ç¹éå­˜å–æ§åˆ¶ï¼Œè®€å–ä¼ºæœå™¨ä¸Šçš„ä»»æ„ â”‚
â”‚  æª”æ¡ˆï¼ˆå¦‚ /etc/passwdï¼‰ã€‚                        â”‚
â”‚                                                 â”‚
â”‚  ğŸ”¬ æª¢æ¸¬æ–¹æ³•ï¼š                                   â”‚
â”‚  ç™¼é€åŒ…å« &quot;/.%2e/&quot; è·¯å¾‘çš„ HTTP è«‹æ±‚ï¼Œå˜—è©¦è®€å–    â”‚
â”‚  æ•æ„Ÿæª”æ¡ˆã€‚è‹¥æˆåŠŸè¿”å›æª”æ¡ˆå…§å®¹ï¼Œå‰‡ç¢ºèªæ¼æ´å­˜åœ¨ã€‚ â”‚
â”‚                                                 â”‚
â”‚  [ æ¸¬è©¦æ­¤æ¼æ´ ]  [ æŸ¥çœ‹è©³ç´°è³‡è¨Š ]                â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ğŸŸ  High - CVE-2021-28041                       â”‚
â”‚  å½±éŸ¿çµ„ä»¶ï¼šOpenSSL 1.1.1d                       â”‚
â”‚  æ¼æ´é¡å‹ï¼šX509 æ†‘è­‰é©—è­‰ç¹é                    â”‚
â”‚  CVSS è©•åˆ†ï¼š7.4 / 10.0                          â”‚
â”‚  [ æ¸¬è©¦æ­¤æ¼æ´ ]                                  â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ğŸŸ¡ Medium - å…¶ä»– 3 å€‹æ¼æ´                      â”‚
â”‚  [ å±•é–‹æŸ¥çœ‹ ]                                    â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3>å¾Œç«¯è™•ç†æµç¨‹</h3>
<pre class="codehilite"><code class="language-python">class IntelligenceDrivenScanner:
    async def analyze_target(self, target: str) -&gt; IntelligenceReport:
        # 1. å¿«é€Ÿåµå¯Ÿ
        recon_results = await self._quick_reconnaissance(target)

        # 2. æå–æŠ€è¡“æ£§
        tech_stack = self._extract_tech_stack(recon_results)

        # 3. æŸ¥è©¢ CVE è³‡æ–™åº«
        related_cves = await self._query_cve_database(tech_stack)

        # 4. æ’åºèˆ‡å„ªå…ˆç´š
        prioritized_cves = self._prioritize_by_severity(related_cves)

        # 5. ç‚ºæ¯å€‹ CVE æº–å‚™æª¢æ¸¬è³‡è¨Š
        suggestions = []
        for cve in prioritized_cves:
            suggestion = CVESuggestion(
                cve_id=cve.id,
                severity=cve.severity,
                cvss_score=cve.cvss_score,
                description=cve.description,
                affected_component=cve.affected_component,
                detection_method=await self._get_detection_method(cve),
                exploit_available=cve.exploit_available
            )
            suggestions.append(suggestion)

        return IntelligenceReport(
            target=target,
            tech_stack=tech_stack,
            suggestions=suggestions,
            scan_timestamp=datetime.now()
        )

    async def _query_cve_database(self, tech_stack: TechStack) -&gt; list[CVE]:
        &quot;&quot;&quot;æŸ¥è©¢ç›¸é—œ CVE&quot;&quot;&quot;
        cves = []
        for component in tech_stack.components:
            # ä½¿ç”¨ CPE (Common Platform Enumeration) æ ¼å¼æŸ¥è©¢
            cpe = f&quot;cpe:2.3:a:{component.vendor}:{component.name}:{component.version}&quot;

            query = &quot;&quot;&quot;
            SELECT * FROM cve_database
            WHERE affected_cpe @&gt; %s::jsonb
            ORDER BY cvss_score DESC
            LIMIT 10
            &quot;&quot;&quot;
            results = await self.db.fetch(query, json.dumps([cpe]))
            cves.extend(results)

        return cves

    async def _get_detection_method(self, cve: CVE) -&gt; DetectionMethod:
        &quot;&quot;&quot;å¾çŸ¥è­˜åº«æˆ– LLM ç²å–æª¢æ¸¬æ–¹æ³•&quot;&quot;&quot;
        # å…ˆå˜—è©¦å¾çŸ¥è­˜åº«å–å¾—é å®šç¾©çš„æª¢æ¸¬æ–¹æ³•
        method = await self.kb.get_detection_method(cve.id)

        if method is None:
            # è‹¥ç„¡é å®šç¾©æ–¹æ³•ï¼Œè«‹ LLM ç”Ÿæˆ
            prompt = f&quot;&quot;&quot;
            Given the following CVE, describe a safe and effective method to detect if a target is vulnerable:

            CVE ID: {cve.id}
            Description: {cve.description}
            Affected Component: {cve.affected_component}

            Provide:
            1. A brief explanation of how to test for this vulnerability
            2. The expected behavior if vulnerable
            3. The expected behavior if not vulnerable
            &quot;&quot;&quot;
            response = await self.llm.complete(prompt)
            method = DetectionMethod.from_llm_response(response)

        return method
</code></pre>

<h3>CVE é©—è­‰è…³æœ¬ç”Ÿæˆ</h3>
<p>ç•¶ä½¿ç”¨è€…é¸æ“‡æ¸¬è©¦æŸå€‹ CVE æ™‚ï¼Œç³»çµ±ç”Ÿæˆå°ˆç”¨è…³æœ¬ï¼š</p>
<pre class="codehilite"><code class="language-python">async def generate_cve_verification_script(cve_id: str, target: str) -&gt; str:
    cve_details = await db.get_cve(cve_id)

    prompt = f&quot;&quot;&quot;
    As a senior penetration tester with expertise in {cve_details.affected_component},
    write a Python script to safely verify if {target} is vulnerable to {cve_id}.

    CVE Details:
    - Description: {cve_details.description}
    - Type: {cve_details.vulnerability_type}
    - CVSS Score: {cve_details.cvss_score}

    Verification Approach:
    {cve_details.detection_method}

    Requirements:
    1. Use the 'requests' library for HTTP interactions
    2. Implement EXACTLY the verification steps described above
    3. Print JSON output with:
       - &quot;status&quot;: &quot;VULNERABLE&quot; | &quot;NOT_VULNERABLE&quot; | &quot;UNCERTAIN&quot;
       - &quot;confidence&quot;: float (0.0 to 1.0)
       - &quot;evidence&quot;: dict with relevant details
    4. Set reasonable timeouts (5 seconds)
    5. Handle all exceptions gracefully
    6. DO NOT cause damage or service disruption

    CRITICAL SAFETY RULES:
    - This is authorized security testing only
    - Use minimal payloads necessary for verification
    - Do not attempt exploitation beyond verification
    &quot;&quot;&quot;

    response = await llm_client.complete(prompt)
    script = extract_code_from_response(response)

    return script
</code></pre>

<hr />
<h2>æ¨¡å¼ä¸‰ï¼šå°è©±å¼æƒæ (Conversational Scan)</h2>
<h3>è¨­è¨ˆç†å¿µ</h3>
<p><strong>å°‡ LLM è½‰åŒ–ç‚ºä¸€ä½è³‡å®‰å°å¸«ï¼Œé€éè˜‡æ ¼æ‹‰åº•å¼å°è©±å¼•å°ä½¿ç”¨è€…ç†è§£è³‡å®‰è­°é¡Œï¼Œå…±åŒæ±ºå®šæª¢æ¸¬ç­–ç•¥ã€‚</strong></p>
<h3>é©ç”¨å ´æ™¯</h3>
<ul>
<li>å­¸ç¿’è³‡å®‰çš„å­¸ç”Ÿï¼Œæƒ³æ·±å…¥ç†è§£æ¯å€‹æ­¥é©Ÿçš„æ„ç¾©</li>
<li>æ¢ç´¢æ€§æ¸¬è©¦ï¼Œä¸ç¢ºå®šæ‡‰è©²å¾ä½•é–‹å§‹</li>
<li>å¸Œæœ›ç³»çµ±è§£é‡‹ã€Œç‚ºä»€éº¼ã€è€Œä¸åªæ˜¯ã€Œæ€éº¼åšã€</li>
</ul>
<h3>äº’å‹•æµç¨‹</h3>
<pre class="codehilite"><code>ä½¿ç”¨è€…ï¼š&quot;æˆ‘æƒ³æ¸¬è©¦ç¶²ç«™çš„å®‰å…¨æ€§&quot;
    â†“
ç³»çµ±ï¼š&quot;å¾ˆå¥½ï¼é¦–å…ˆï¼Œæ‚¨å°é€™å€‹ç¶²ç«™æœ‰å¤šå°‘äº†è§£ï¼Ÿæ‚¨çŸ¥é“å®ƒä½¿ç”¨ä»€éº¼æŠ€è¡“å—ï¼Ÿ&quot;
    â†“
ä½¿ç”¨è€…ï¼š&quot;ä¸å¤ªæ¸…æ¥šï¼Œæ‡‰è©²å¦‚ä½•é–‹å§‹ï¼Ÿ&quot;
    â†“
ç³»çµ±ï¼š&quot;åœ¨è³‡å®‰æ¸¬è©¦ä¸­ï¼Œæˆ‘å€‘é€šå¸¸å¾ã€Œè³‡è¨Šæ”¶é›†ã€é–‹å§‹ã€‚æˆ‘å»ºè­°ä½¿ç”¨ nmap
      æƒæé–‹æ”¾é€£æ¥åŸ ï¼Œä»¥åŠ curl åˆ†æ HTTP Headerã€‚æ‚¨æƒ³äº†è§£é€™äº›å·¥å…·çš„
      é‹ä½œåŸç†å—ï¼Ÿ&quot;
    â†“
ä½¿ç”¨è€…ï¼š&quot;å¯ä»¥ï¼Œè«‹è§£é‡‹ä¸€ä¸‹ nmap&quot;
    â†“
ç³»çµ±ï¼š[æä¾› nmap çš„è§£é‡‹èˆ‡åŸç†]
      &quot;æˆ‘ç¾åœ¨å¯ä»¥ç‚ºæ‚¨ç”Ÿæˆä¸€å€‹ nmap æƒæè…³æœ¬ï¼Œæ‚¨ç¢ºå®šè¦åŸ·è¡Œå—ï¼Ÿ&quot;
    â†“
ä½¿ç”¨è€…ï¼š&quot;å¥½çš„ï¼ŒåŸ·è¡Œå§&quot;
    â†“
ç³»çµ±ï¼š[åŸ·è¡Œè…³æœ¬ä¸¦è¿”å›çµæœ]
      &quot;æƒæç™¼ç¾æ‚¨çš„ç¶²ç«™é‹è¡Œ Apache 2.4.49ã€‚æ ¹æ“š CVE è³‡æ–™åº«ï¼Œé€™å€‹ç‰ˆæœ¬
      å­˜åœ¨ä¸€å€‹åš´é‡çš„è·¯å¾‘ç©¿è¶Šæ¼æ´ (CVE-2021-41773)ã€‚æ‚¨æƒ³æ¸¬è©¦çœ‹çœ‹æ˜¯å¦
      çœŸçš„å­˜åœ¨é€™å€‹æ¼æ´å—ï¼Ÿ&quot;
</code></pre>

<h3>UI è¨­è¨ˆï¼šèŠå¤©ä»‹é¢</h3>
<pre class="codehilite"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¬ å°è©±å¼æƒæ                    [?] [âš™ï¸] [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ğŸ‘¤ æˆ‘æƒ³æ¸¬è©¦ https://example.com çš„å®‰å…¨æ€§        â”‚
â”‚                                        14:32    â”‚
â”‚                                                 â”‚
â”‚  ğŸ¤– å¾ˆå¥½ï¼è®“æˆ‘å…ˆäº†è§£ä¸€ä¸‹æƒ…æ³ã€‚è«‹å•æ‚¨å°é€™å€‹ç¶²ç«™  â”‚
â”‚     æœ‰å¤šå°‘äº†è§£ï¼Ÿä¾‹å¦‚ï¼š                          â”‚
â”‚     â€¢ æ‚¨çŸ¥é“å®ƒä½¿ç”¨ä»€éº¼ Web ä¼ºæœå™¨å—ï¼Ÿ           â”‚
â”‚     â€¢ æ˜¯å¦æœ‰ç‰¹å®šçš„å®‰å…¨å•é¡Œæ‚¨æƒ³é‡é»æª¢æ¸¬ï¼Ÿ        â”‚
â”‚     â€¢ æ‚¨é€²è¡Œéé¡ä¼¼çš„æ¸¬è©¦å—ï¼Ÿ                    â”‚
â”‚                                        14:32    â”‚
â”‚                                                 â”‚
â”‚  ğŸ‘¤ æˆ‘ä¸å¤ªæ¸…æ¥šï¼Œæ‡‰è©²å¾ä½•é–‹å§‹ï¼Ÿ                   â”‚
â”‚                                        14:33    â”‚
â”‚                                                 â”‚
â”‚  ğŸ¤– æ²’å•é¡Œï¼é€™æ˜¯å¾ˆå…¸å‹çš„æƒ…æ³ã€‚åœ¨è³‡å®‰æ¸¬è©¦ä¸­ï¼Œæˆ‘å€‘ â”‚
â”‚     éµå¾ªä¸€å€‹æ¨™æº–æµç¨‹ï¼š                          â”‚
â”‚                                                 â”‚
â”‚     ğŸ“Š éšæ®µä¸€ï¼šè³‡è¨Šæ”¶é›† (Reconnaissance)        â”‚
â”‚     ç›®æ¨™ï¼šäº†è§£ç›®æ¨™çš„æŠ€è¡“æ¶æ§‹                    â”‚
â”‚                                                 â”‚
â”‚     æˆ‘å»ºè­°æˆ‘å€‘å…ˆåŸ·è¡ŒåŸºç¤æƒæï¼š                  â”‚
â”‚     ğŸ”¹ nmapï¼šæƒæé–‹æ”¾çš„ç¶²è·¯é€£æ¥åŸ                â”‚
â”‚     ğŸ”¹ curlï¼šåˆ†æ HTTP å›æ‡‰æ¨™é ­                 â”‚
â”‚                                                 â”‚
â”‚     é€™å…©å€‹å·¥å…·æœƒå¹«åŠ©æˆ‘å€‘è­˜åˆ¥ä¼ºæœå™¨é¡å‹ã€ç‰ˆæœ¬ç­‰  â”‚
â”‚     è³‡è¨Šã€‚æ‚¨æƒ³å…ˆäº†è§£é€™äº›å·¥å…·å¦‚ä½•é‹ä½œï¼Œé‚„æ˜¯ç›´æ¥  â”‚
â”‚     é–‹å§‹æƒæï¼Ÿ                                  â”‚
â”‚                                        14:33    â”‚
â”‚     [ äº†è§£å·¥å…·åŸç† ] [ ç›´æ¥é–‹å§‹æƒæ ]           â”‚
â”‚                                                 â”‚
â”‚  ğŸ‘¤ [é»é¸] ç›´æ¥é–‹å§‹æƒæ                         â”‚
â”‚                                        14:34    â”‚
â”‚                                                 â”‚
â”‚  ğŸ¤– å¥½çš„ï¼æˆ‘ç¾åœ¨æœƒç”Ÿæˆä¸€å€‹ Python è…³æœ¬ä¾†åŸ·è¡Œé€™   â”‚
â”‚     å€‹æƒæã€‚è®“æˆ‘å±•ç¤ºçµ¦æ‚¨çœ‹ï¼š                    â”‚
â”‚                                                 â”‚
â”‚     ```python                                   â”‚
â”‚     import subprocess                           â”‚
â”‚     import requests                             â”‚
â”‚                                                 â”‚
â”‚     # nmap æƒæå¸¸è¦‹ Web é€£æ¥åŸ                    â”‚
â”‚     result = subprocess.run([                   â”‚
â”‚         'nmap', '-sV', '-p', '80,443,8080',     â”‚
â”‚         'example.com'                           â”‚
â”‚     ], capture_output=True)                     â”‚
â”‚     ...                                         â”‚
â”‚     ```                                         â”‚
â”‚                                                 â”‚
â”‚     é€™å€‹è…³æœ¬æœƒï¼š                                â”‚
â”‚     1ï¸âƒ£ æƒæ 80, 443, 8080 é€™ä¸‰å€‹å¸¸è¦‹ Web é€£æ¥åŸ  â”‚
â”‚     2ï¸âƒ£ å˜—è©¦è­˜åˆ¥å„é€£æ¥åŸ é‹è¡Œçš„æœå‹™ç‰ˆæœ¬           â”‚
â”‚     3ï¸âƒ£ ä½¿ç”¨ curl ç²å– HTTP æ¨™é ­                 â”‚
â”‚                                                 â”‚
â”‚     é ä¼°åŸ·è¡Œæ™‚é–“ï¼š2-3 åˆ†é˜                      â”‚
â”‚     [ åŸ·è¡Œè…³æœ¬ ] [ ä¿®æ”¹åƒæ•¸ ] [ å–æ¶ˆ ]           â”‚
â”‚                                        14:34    â”‚
â”‚                                                 â”‚
â”‚  ğŸ‘¤ [é»é¸] åŸ·è¡Œè…³æœ¬                             â”‚
â”‚                                        14:35    â”‚
â”‚                                                 â”‚
â”‚  ğŸ¤– â³ æ­£åœ¨åŸ·è¡Œæƒæ...                           â”‚
â”‚     [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘] 70% - nmap æƒæä¸­        â”‚
â”‚                                        14:35    â”‚
â”‚                                                 â”‚
â”‚  ğŸ¤– âœ… æƒæå®Œæˆï¼è®“æˆ‘åˆ†æçµæœ...                 â”‚
â”‚                                                 â”‚
â”‚     ğŸ“Š ç™¼ç¾è³‡è¨Šï¼š                                â”‚
â”‚     â€¢ é–‹æ”¾é€£æ¥åŸ ï¼š80 (HTTP), 443 (HTTPS)        â”‚
â”‚     â€¢ Web ä¼ºæœå™¨ï¼šApache httpd 2.4.49           â”‚
â”‚     â€¢ ä½œæ¥­ç³»çµ±ï¼šæ¨æ¸¬ç‚º Unix/Linux               â”‚
â”‚                                                 â”‚
â”‚     âš ï¸ é‡è¦ç™¼ç¾ï¼š                                â”‚
â”‚     æˆ‘åœ¨ CVE è³‡æ–™åº«ä¸­æ‰¾åˆ° Apache 2.4.49 æœ‰ä¸€å€‹  â”‚
â”‚     **Critical ç­‰ç´šçš„æ¼æ´** (CVE-2021-41773)ï¼  â”‚
â”‚                                                 â”‚
â”‚     ğŸ“– æ¼æ´èªªæ˜ï¼š                                â”‚
â”‚     é€™æ˜¯ä¸€å€‹è·¯å¾‘ç©¿è¶Šæ¼æ´ï¼Œæ”»æ“Šè€…å¯èƒ½ç¹éå­˜å–æ§åˆ¶â”‚
â”‚     è®€å–ä¼ºæœå™¨ä¸Šçš„ä»»æ„æª”æ¡ˆï¼ˆä¾‹å¦‚ /etc/passwdï¼‰ã€‚â”‚
â”‚                                                 â”‚
â”‚     æ‚¨æƒ³é€²ä¸€æ­¥æ¸¬è©¦é€™å€‹æ¼æ´æ˜¯å¦çœŸçš„å­˜åœ¨å—ï¼Ÿ      â”‚
â”‚                                        14:36    â”‚
â”‚     [ æ˜¯ï¼Œæ¸¬è©¦æ¼æ´ ] [ å…ˆäº†è§£è·¯å¾‘ç©¿è¶ŠåŸç† ]      â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ ğŸ’¬ è¼¸å…¥è¨Šæ¯...                          [ğŸ“] [ğŸ¤]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3>å°è©±ç®¡ç†æ¶æ§‹</h3>
<pre class="codehilite"><code class="language-python">class ConversationalAgent:
    def __init__(self, llm_client, knowledge_base, executor):
        self.llm = llm_client
        self.kb = knowledge_base
        self.executor = executor
        self.conversation_history = []
        self.context = ConversationContext()

    async def process_message(self, user_message: str) -&gt; AgentResponse:
        # 1. æ›´æ–°å°è©±æ­·å²
        self.conversation_history.append({
            &quot;role&quot;: &quot;user&quot;,
            &quot;content&quot;: user_message
        })

        # 2. æ„åœ–è­˜åˆ¥
        intent = await self._classify_intent(user_message)

        # 3. æ ¹æ“šæ„åœ–ç”Ÿæˆå›æ‡‰
        if intent == &quot;ask_for_explanation&quot;:
            response = await self._provide_explanation(user_message)

        elif intent == &quot;request_scan&quot;:
            response = await self._propose_scan_plan(user_message)

        elif intent == &quot;confirm_action&quot;:
            response = await self._execute_confirmed_action()

        elif intent == &quot;explore_topic&quot;:
            response = await self._guide_exploration(user_message)

        # 4. æ›´æ–°ä¸Šä¸‹æ–‡
        self.context.update(intent, response)

        # 5. æ›´æ–°å°è©±æ­·å²
        self.conversation_history.append({
            &quot;role&quot;: &quot;assistant&quot;,
            &quot;content&quot;: response.text
        })

        return response

    async def _propose_scan_plan(self, user_message: str) -&gt; AgentResponse:
        &quot;&quot;&quot;æå‡ºæƒæè¨ˆç•«ä¸¦å°‹æ±‚ç¢ºèª&quot;&quot;&quot;
        prompt = f&quot;&quot;&quot;
        You are a cybersecurity mentor having a conversation with a learner.

        Conversation history:
        {self._format_conversation_history()}

        User just said: &quot;{user_message}&quot;

        Your task:
        1. Acknowledge their request
        2. Suggest appropriate tools and tests
        3. Explain WHY these tools are suitable
        4. Generate a Python script if appropriate
        5. Ask for confirmation before execution

        Response format:
        - Use friendly, educational tone
        - Provide context and reasoning
        - Offer choices (e.g., &quot;learn more&quot; vs &quot;proceed&quot;)
        &quot;&quot;&quot;

        llm_response = await self.llm.complete(prompt)

        # è§£æ LLM å›æ‡‰ï¼Œæå–è…³æœ¬ï¼ˆå¦‚æœæœ‰ï¼‰
        script = self._extract_script_from_response(llm_response)

        return AgentResponse(
            text=llm_response,
            proposed_script=script,
            requires_confirmation=True if script else False,
            suggested_actions=[
                {&quot;label&quot;: &quot;åŸ·è¡Œè…³æœ¬&quot;, &quot;action&quot;: &quot;execute&quot;},
                {&quot;label&quot;: &quot;ä¿®æ”¹åƒæ•¸&quot;, &quot;action&quot;: &quot;modify&quot;},
                {&quot;label&quot;: &quot;äº†è§£æ›´å¤š&quot;, &quot;action&quot;: &quot;explain&quot;}
            ]
        )
</code></pre>

<h3>æ•™å­¸å¢å¼·åŠŸèƒ½</h3>
<p><strong>å…§å»ºçŸ¥è­˜åº«æŸ¥è©¢</strong></p>
<p>ç•¶ä½¿ç”¨è€…è©¢å•æ¦‚å¿µæ€§å•é¡Œæ™‚ï¼Œç³»çµ±å¯æŸ¥è©¢å…§éƒ¨çŸ¥è­˜åº«ï¼š</p>
<pre class="codehilite"><code class="language-python">async def _provide_explanation(self, query: str) -&gt; AgentResponse:
    # æŸ¥è©¢çŸ¥è­˜åº«
    kb_result = await self.kb.search(query)

    if kb_result:
        # ä½¿ç”¨çŸ¥è­˜åº«å…§å®¹ï¼Œä½†è®“ LLM ç”¨å°è©±æ–¹å¼å‘ˆç¾
        prompt = f&quot;&quot;&quot;
        Explain the following concept in a conversational, educational manner:

        Concept: {query}
        Knowledge Base Info: {kb_result.content}

        Adapt your explanation to the user's level based on conversation history:
        {self._format_conversation_history()}
        &quot;&quot;&quot;
    else:
        # ç„¡çŸ¥è­˜åº«è³‡æ–™ï¼Œè®“ LLM è‡ªç”±å›æ‡‰
        prompt = f&quot;&quot;&quot;
        The user asked: &quot;{query}&quot;
        Provide a clear, educational explanation suitable for someone learning cybersecurity.
        &quot;&quot;&quot;

    response = await self.llm.complete(prompt)
    return AgentResponse(text=response)
</code></pre>

<hr />
<h2>æ¨¡å¼å››ï¼šå…¨è‡ªå‹•åŒ–æƒæ (Fully Automated Scan)</h2>
<h3>è¨­è¨ˆç†å¿µ</h3>
<p><strong>æä¾›ä¸€éµåŸ·è¡Œçš„å®Œæ•´æƒæç­–ç•¥ï¼Œæ»¿è¶³ä¼æ¥­ç”¨æˆ¶èˆ‡å°ˆæ¥­äººå£«çš„æ•ˆç‡éœ€æ±‚ã€‚</strong></p>
<h3>é©ç”¨å ´æ™¯</h3>
<ul>
<li>å®šæœŸï¼ˆæ¯é€±/æ¯æœˆï¼‰çš„è³‡å®‰å¥æª¢</li>
<li>CI/CD æµç¨‹ä¸­çš„è‡ªå‹•åŒ–å®‰å…¨æª¢æ¸¬</li>
<li>å¿«é€Ÿç²å¾—å…¨é¢è©•ä¼°å ±å‘Š</li>
</ul>
<h3>é è¨­æƒæç­–ç•¥</h3>
<p>ç³»çµ±æä¾›å¤šç¨®é å®šç¾©ç­–ç•¥ï¼š</p>
<h4>ç­–ç•¥ä¸€ï¼šå¿«é€Ÿæƒæ (Quick Scan)</h4>
<ul>
<li><strong>æ™‚é–“</strong>ï¼š5-10 åˆ†é˜</li>
<li><strong>æª¢æ¸¬é …ç›®</strong>ï¼š</li>
<li>åŸºç¤è³‡è¨Šç›¤é»</li>
<li>SSL/TLS æª¢æŸ¥</li>
<li>HTTP å®‰å…¨æ¨™é ­æª¢æŸ¥</li>
<li><strong>é©ç”¨</strong>ï¼šæ—¥å¸¸å¿«é€Ÿæª¢æŸ¥</li>
</ul>
<h4>ç­–ç•¥äºŒï¼šæ¨™æº–æƒæ (Standard Scan)</h4>
<ul>
<li><strong>æ™‚é–“</strong>ï¼š20-30 åˆ†é˜</li>
<li><strong>æª¢æ¸¬é …ç›®</strong>ï¼š</li>
<li>å¿«é€Ÿæƒæçš„æ‰€æœ‰é …ç›®</li>
<li>Web ä¼ºæœå™¨å·²çŸ¥æ¼æ´æƒæ</li>
<li>å¸¸è¦‹ç›®éŒ„/æª”æ¡ˆæšèˆ‰</li>
<li>åŸºç¤è¼¸å…¥é©—è­‰æ¸¬è©¦</li>
<li><strong>é©ç”¨</strong>ï¼šå®šæœŸå¥æª¢</li>
</ul>
<h4>ç­–ç•¥ä¸‰ï¼šæ·±åº¦æƒæ (Comprehensive Scan)</h4>
<ul>
<li><strong>æ™‚é–“</strong>ï¼š1-2 å°æ™‚</li>
<li><strong>æª¢æ¸¬é …ç›®</strong>ï¼š</li>
<li>æ¨™æº–æƒæçš„æ‰€æœ‰é …ç›®</li>
<li>SQL Injection å®Œæ•´æ¸¬è©¦</li>
<li>XSS æª¢æ¸¬</li>
<li>CSRF æª¢æ¸¬</li>
<li>èªè­‰/æˆæ¬Šæ¸¬è©¦</li>
<li>æ•æ„Ÿè³‡è¨Šæ´©æ¼æ·±åº¦æª¢æ¸¬</li>
<li><strong>é©ç”¨</strong>ï¼šé‡è¦æ›´æ–°å‰çš„å…¨é¢æª¢æ¸¬</li>
</ul>
<h3>UI è¨­è¨ˆ</h3>
<pre class="codehilite"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš€ å…¨è‡ªå‹•åŒ–æƒæ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç›®æ¨™ï¼šhttps://example.com                      â”‚
â”‚                                                 â”‚
â”‚  é¸æ“‡æƒæç­–ç•¥ï¼š                                  â”‚
â”‚                                                 â”‚
â”‚  â—‹ âš¡ å¿«é€Ÿæƒæ (5-10 åˆ†é˜)                       â”‚
â”‚    åŸºç¤å®‰å…¨æª¢æŸ¥ï¼Œé©åˆæ—¥å¸¸ç›£æ§                    â”‚
â”‚                                                 â”‚
â”‚  â— ğŸ¯ æ¨™æº–æƒæ (20-30 åˆ†é˜) [æ¨è–¦]              â”‚
â”‚    å…¨é¢çš„å®‰å…¨è©•ä¼°ï¼Œæ¶µè“‹å¸¸è¦‹æ¼æ´                  â”‚
â”‚                                                 â”‚
â”‚  â—‹ ğŸ”¬ æ·±åº¦æƒæ (1-2 å°æ™‚)                       â”‚
â”‚    å¾¹åº•çš„æ»²é€æ¸¬è©¦ç´šåˆ¥æª¢æ¸¬                        â”‚
â”‚                                                 â”‚
â”‚  â—‹ ğŸ› ï¸ è‡ªè¨‚ç­–ç•¥                                  â”‚
â”‚    [ å»ºç«‹è‡ªè¨‚æƒæç­–ç•¥ ]                          â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é€²éšé¸é …ï¼š                                      â”‚
â”‚  â˜‘ ç™¼ç¾é«˜é¢¨éšªæ¼æ´æ™‚ç«‹å³é€šçŸ¥                     â”‚
â”‚  â˜‘ å®Œæˆå¾Œè‡ªå‹•ç”Ÿæˆ PDF å ±å‘Š                      â”‚
â”‚  â˜ çµæœæ¯”å°ä¸Šæ¬¡æƒæï¼ˆè¶¨å‹¢åˆ†æï¼‰                 â”‚
â”‚  â˜ åŒæ™‚æƒæå­ç¶²åŸŸ                               â”‚
â”‚                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ’ç¨‹è¨­å®šï¼š                                      â”‚
â”‚  â—‹ ç«‹å³åŸ·è¡Œ                                     â”‚
â”‚  â—‹ æ’ç¨‹åŸ·è¡Œï¼š[æ¯é€±ä¸€] [02:00] UTC               â”‚
â”‚                                                 â”‚
â”‚                              [ å–æ¶ˆ ] [ é–‹å§‹æƒæ ]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3>å¾Œç«¯å¯¦ä½œ</h3>
<pre class="codehilite"><code class="language-python">class AutomatedScanStrategy(BaseModel):
    id: str
    name: str
    description: str
    estimated_duration_min: int
    tasks: list[ScanTask]

# æ¨™æº–æƒæç­–ç•¥å®šç¾©
STANDARD_SCAN = AutomatedScanStrategy(
    id=&quot;standard&quot;,
    name=&quot;æ¨™æº–æƒæ&quot;,
    description=&quot;å…¨é¢çš„å®‰å…¨è©•ä¼°ï¼Œæ¶µè“‹å¸¸è¦‹æ¼æ´&quot;,
    estimated_duration_min=25,
    tasks=[
        ScanTask(
            name=&quot;è³‡è¨Šæ”¶é›†&quot;,
            tool=&quot;nmap&quot;,
            params={&quot;scan_type&quot;: &quot;version_detection&quot;, &quot;ports&quot;: &quot;80,443,8080,8443&quot;}
        ),
        ScanTask(
            name=&quot;SSL/TLS æª¢æŸ¥&quot;,
            tool=&quot;sslyze&quot;,
            params={&quot;check_certificate&quot;: True, &quot;check_cipher_suites&quot;: True}
        ),
        ScanTask(
            name=&quot;HTTP å®‰å…¨æ¨™é ­&quot;,
            tool=&quot;custom_script&quot;,
            script_template=&quot;http_headers_check&quot;
        ),
        ScanTask(
            name=&quot;CVE æƒ…è³‡æƒæ&quot;,
            tool=&quot;cve_check&quot;,
            depends_on=&quot;è³‡è¨Šæ”¶é›†&quot;  # ä¾è³´å‰é¢ä»»å‹™çš„çµæœ
        ),
        ScanTask(
            name=&quot;Web ä¼ºæœå™¨æ¼æ´æƒæ&quot;,
            tool=&quot;nikto&quot;,
            params={&quot;tuning&quot;: &quot;x6&quot;}  # è·³é DoS æ¸¬è©¦
        ),
        ScanTask(
            name=&quot;ç›®éŒ„æšèˆ‰&quot;,
            tool=&quot;gobuster&quot;,
            params={&quot;wordlist&quot;: &quot;common.txt&quot;, &quot;threads&quot;: 10}
        ),
        ScanTask(
            name=&quot;è¼¸å…¥é©—è­‰æ¸¬è©¦&quot;,
            tool=&quot;custom_script&quot;,
            script_template=&quot;basic_input_validation&quot;
        )
    ]
)

class AutomatedScanner:
    async def execute_strategy(
        self,
        strategy: AutomatedScanStrategy,
        target: str
    ) -&gt; ScanReport:
        scan_id = str(uuid.uuid4())
        results = []

        # å»ºç«‹ä»»å‹™ç›¸ä¾åœ–
        task_graph = self._build_dependency_graph(strategy.tasks)

        # ä¾åºåŸ·è¡Œä»»å‹™
        for task in self._topological_sort(task_graph):
            try:
                # å¦‚æœä»»å‹™ä¾è³´å‰é¢çš„çµæœï¼Œå‚³å…¥ä¸Šä¸‹æ–‡
                context = self._build_task_context(task, results)

                result = await self._execute_task(task, target, context)
                results.append(result)

                # å³æ™‚æ›´æ–°é€²åº¦
                await self._update_progress(scan_id, results)

                # é«˜é¢¨éšªç™¼ç¾ç«‹å³é€šçŸ¥
                if result.has_critical_findings():
                    await self._send_alert(scan_id, result)

            except TaskExecutionError as e:
                # è¨˜éŒ„éŒ¯èª¤ä½†ç¹¼çºŒåŸ·è¡Œå…¶ä»–ä»»å‹™
                await self._log_task_error(scan_id, task.name, e)
                continue

        # å½™æ•´æœ€çµ‚å ±å‘Š
        report = await self._generate_comprehensive_report(
            scan_id, target, strategy, results
        )

        return report
</code></pre>

<h3>é€²åº¦è¿½è¹¤èˆ‡å³æ™‚é€šçŸ¥</h3>
<pre class="codehilite"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ æƒæé€²è¡Œä¸­ - æ¨™æº–æƒæ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç›®æ¨™ï¼šhttps://example.com                      â”‚
â”‚  å·²é‹è¡Œï¼š12 åˆ†é˜ / é ä¼°ï¼š25 åˆ†é˜                 â”‚
â”‚                                                 â”‚
â”‚  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 65%                â”‚
â”‚                                                 â”‚
â”‚  âœ… è³‡è¨Šæ”¶é›† (å®Œæˆ - 2.3 åˆ†é˜)                   â”‚
â”‚  âœ… SSL/TLS æª¢æŸ¥ (å®Œæˆ - 1.8 åˆ†é˜)               â”‚
â”‚  âœ… HTTP å®‰å…¨æ¨™é ­ (å®Œæˆ - 0.5 åˆ†é˜)              â”‚
â”‚  âœ… CVE æƒ…è³‡æƒæ (å®Œæˆ - 3.1 åˆ†é˜)               â”‚
â”‚     â””â”€ âš ï¸ ç™¼ç¾ 2 å€‹ Critical ç­‰ç´š CVE            â”‚
â”‚  ğŸ”„ Web ä¼ºæœå™¨æ¼æ´æƒæ (é€²è¡Œä¸­...)               â”‚
â”‚  â³ ç›®éŒ„æšèˆ‰ (ç­‰å¾…ä¸­)                            â”‚
â”‚  â³ è¼¸å…¥é©—è­‰æ¸¬è©¦ (ç­‰å¾…ä¸­)                        â”‚
â”‚                                                 â”‚
â”‚  [ æš«åœ ] [ åœæ­¢ ] [ æŸ¥çœ‹å³æ™‚æ—¥èªŒ ]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<hr />
<h2>æ¨¡å¼æ¯”è¼ƒèˆ‡é¸æ“‡å»ºè­°</h2>
<table>
<thead>
<tr>
<th>éœ€æ±‚æƒ…å¢ƒ</th>
<th>æ¨è–¦æ¨¡å¼</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>æˆ‘æ˜¯è³‡å®‰åˆå­¸è€…</td>
<td>å¼•å°å¼ + å°è©±å¼</td>
<td>å­¸ç¿’æ›²ç·šå‹å–„ï¼Œæœ‰è§£é‡‹</td>
</tr>
<tr>
<td>æˆ‘æƒ³å¿«é€Ÿæª¢æŸ¥ç¶²ç«™</td>
<td>å¼•å°å¼ / è‡ªå‹•åŒ–</td>
<td>æ˜ç¢ºé¸é …ï¼Œå¿«é€ŸåŸ·è¡Œ</td>
</tr>
<tr>
<td>æˆ‘æƒ³æ·±å…¥å­¸ç¿’è³‡å®‰</td>
<td>å°è©±å¼</td>
<td>äº’å‹•å¼æ•™å­¸é«”é©—</td>
</tr>
<tr>
<td>æˆ‘éœ€è¦å®šæœŸç›£æ§</td>
<td>å…¨è‡ªå‹•åŒ–</td>
<td>å¯æ’ç¨‹ï¼Œç„¡éœ€äººå·¥ä»‹å…¥</td>
</tr>
<tr>
<td>æˆ‘ä¸çŸ¥é“è©²æ¸¬è©¦ä»€éº¼</td>
<td>æƒ…è³‡é©…å‹•</td>
<td>ç³»çµ±ä¸»å‹•å»ºè­°</td>
</tr>
<tr>
<td>æ•´åˆè‡³ CI/CD</td>
<td>å…¨è‡ªå‹•åŒ– (API)</td>
<td>æ”¯æ´ç¨‹å¼åŒ–èª¿ç”¨</td>
</tr>
</tbody>
</table>
<hr />
<p><em>æœ¬æ–‡ä»¶æœ€å¾Œæ›´æ–°ï¼š2025-10-21</em></p>
<p>è¿”å› <a href="./proposal_all.html">ä¸»æ–‡ä»¶</a></p></div>
    
    <!-- Highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            "startOnLoad": true,
            "theme": "dark",
            "securityLevel": "loose"
});
    </script>
</body>
</html>